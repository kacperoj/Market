@model Market.Web.ViewModels.RateOrderViewModel

@{
    ViewData["Title"] = "Oceń zakup";
}

<style>
    /* Prosty system gwiazdek CSS */
    .rating {
        display: flex;
        flex-direction: row-reverse;
        justify-content: center;
        gap: 0.5rem;
    }
    .rating input { display: none; }
    .rating label {
        cursor: pointer;
        width: 40px;
        height: 40px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ddd'%3E%3Cpath d='M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-size: contain;
        transition: transform 0.2s;
    }
    
    /* Efekt po zaznaczeniu lub najechaniu */
    .rating input:checked ~ label,
    .rating label:hover,
    .rating label:hover ~ label {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23ffc107'%3E%3Cpath d='M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z'/%3E%3C/svg%3E");
        transform: scale(1.1);
    }
</style>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            
            <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
                <div class="card-header text-center py-4 border-bottom-0">
                    <h3 class="fw-bold mb-1">Oceń swój zakup</h3>
                    <p class="text-muted mb-0">Twoja opinia pomaga innym użytkownikom.</p>
                </div>
                
                <div class="card-body p-4 pt-0">
                    
                    <!-- Podgląd przedmiotu -->
                    <div class="d-flex align-items-center p-3 rounded-3 mb-4">
                        <img src="@Model.ImageUrl" class="rounded bg-white border" style="width: 60px; height: 60px; object-fit: contain;" alt="thumb">
                        <div class="ms-3">
                            <h6 class="fw-bold mb-1 text-truncate" style="max-width: 250px;">@Model.AuctionTitle</h6>
                            <small class="text-muted">Sprzedawca: <strong>@Model.SellerName</strong></small>
                        </div>
                    </div>

                    <form asp-action="Rate" method="post">
                        <input type="hidden" asp-for="OrderId" />

                        <div class="mb-4 text-center">
                            <label class="form-label fw-bold d-block mb-2">Jak oceniasz transakcję?</label>
                            
                            <div class="rating">
                                <!-- Kolejność odwrócona dla CSS (5 jest pierwsza w kodzie, ale po prawej) -->
                                <input type="radio" id="star5" name="Rating" value="5" /><label for="star5" title="Rewelacja"></label>
                                <input type="radio" id="star4" name="Rating" value="4" /><label for="star4" title="Dobrze"></label>
                                <input type="radio" id="star3" name="Rating" value="3" /><label for="star3" title="Średnio"></label>
                                <input type="radio" id="star2" name="Rating" value="2" /><label for="star2" title="Słabo"></label>
                                <input type="radio" id="star1" name="Rating" value="1" /><label for="star1" title="Tragedia"></label>
                            </div>
                            <span asp-validation-for="Rating" class="text-danger small d-block mt-1"></span>
                        </div>

                        <!-- KOMENTARZ -->
                        <div class="mb-4">
                            <label asp-for="Comment" class="form-label fw-bold">Twój komentarz</label>
                            <textarea asp-for="Comment" class="form-control rounded-3 border-0" rows="4" placeholder="Napisz co Ci się podobało..."></textarea>
                            <span asp-validation-for="Comment" class="text-danger small"></span>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-warning btn-lg rounded-pill fw-bold text-dark shadow-sm">
                                Wyślij Opinię
                            </button>
                            <a asp-action="MyOrders" class="btn btn-link text-muted text-decoration-none">Anuluj</a>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}